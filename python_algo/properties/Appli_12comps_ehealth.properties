# ============================================================================
# IoT Application - e-Health ECG Monitoring Pipeline (12 components)
#
# Application DAG calibrated from recent literature:
#
# [1] Natesha, Venkategowda (2025)
#     "Service Placement in the Computing Continuum for Delay-Sensitive
#      IoT/IIoT Applications"
#     J. Netw. Syst. Manage., vol. 33, art. 64, 2025
#     -> QoS-aware multi-objective placement, Table 3 (app requirements)
#
# [2] Supraja, Chawla (2025)
#     "AI-driven service placement in fog and edge computing environments:
#      a systematic review, taxonomy and future directions"
#     Cluster Computing, vol. 28, 2025
#     DOI: 10.1007/s10586-025-05759-2
#     -> DAG-based IoT application model, Section 3.2 (app structures)
#
# [3] Aburukba, AliKarrar, Landolsi, El-Fakih (2022)
#     "A Novel Low-Latency and Energy-Efficient Task Scheduling Framework
#      for Internet of Medical Things in an Edge Fog Cloud System"
#     Sensors, vol. 22(14):5327, 2022
#     -> EEIoMT architecture: ECG sensor pipeline, Fig. 1
#
# [4] Gia, Jiang, Rahmani, Westerlund, Liljeberg, Tenhunen (2015)
#     "Fog Computing in Healthcare IoT: A Case Study on ECG Feature
#      Extraction", IEEE CIT, pp. 356-363, 2015
#     -> ECG pipeline: signal conditioning + feature extraction, Fig. 2
#
# Application DAG (extended ECG monitoring pipeline):
#
#   C0 (ECG Sensor Hub)      -- bedside, acquires raw ECG + SpO2 + BP
#    |
#   C1 (Signal Conditioner)  -- noise removal, baseline wander correction
#    |
#   C2 (Feature Extractor)   -- R-peak detection, HRV, QRS complex
#   / \
#  C3   C4
#  (Arrhythmia    (Anomaly
#   Classifier)    Detector)    -- parallel ML inference branches
#   \  /
#   C5 (Clinical Decision)   -- fuses classif + anomaly into risk score
#    |           \
#   C6            C7
#  (Alert         (Patient
#   Engine)        Dashboard)  -- real-time alert + nurse station display
#    |
#   C8 (Notification Service) -- push alerts to mobile devices
#    |
#   C9 (Ward Aggregator)     -- aggregates patient data per ward
#    |
#   C10 (EHR Connector)      -- writes to Electronic Health Record
#    |
#   C11 (Cloud Analytics)    -- long-term analytics, ML training, archival
#
# This extends Gia et al.'s 4-stage ECG pipeline with:
#   - Dual-path inference (C3 arrhythmia + C4 anomaly) from EEIoMT
#   - Clinical Decision (C5) risk scoring from Mahmud QoE model
#   - Alert Engine (C6) with real-time notification chain (C8)
#   - Patient Dashboard (C7) for nurse station
#   - Ward Aggregator (C9) for multi-patient view
#   - EHR/Cloud path (C10, C11) for compliance and analytics
#
# ECG data rate from Gia et al. 2015: 250 Hz, 12-lead, ~72 kbps raw
# Processed features: ~2 kbps compressed per patient
# ============================================================================

application.nb = 1

# 12 components
application.components = 12

# {CPU, RAM, lambda (data flow rate), mu (processing rate)}
# C0:  ECG Sensor Hub       - bedside device, minimal compute
# C1:  Signal Conditioner   - lightweight DSP filtering
# C2:  Feature Extractor    - moderate: FFT, wavelet transforms
# C3:  Arrhythmia Classif.  - heavy: DNN inference (~4 vCPU)
# C4:  Anomaly Detector     - heavy: ensemble models (~3 vCPU)
# C5:  Clinical Decision    - moderate: risk scoring logic
# C6:  Alert Engine         - light: threshold + routing
# C7:  Patient Dashboard    - light: visualization rendering
# C8:  Notification Service - light: push notification dispatch
# C9:  Ward Aggregator      - moderate: multi-patient aggregation
# C10: EHR Connector        - moderate: HL7/FHIR formatting + write
# C11: Cloud Analytics      - heavy: long-term ML + archival
components.requirements = \
{1,1000,500,600}, \
{1,2000,400,500}, \
{2,4000,350,400}, \
{4,8000,200,250}, \
{3,6000,200,250}, \
{2,4000,300,350}, \
{1,1000,150,200}, \
{1,2000,150,200}, \
{1,1000,100,150}, \
{2,4000,200,250}, \
{2,4000,150,200}, \
{4,8000,100,150}

# Links follow the DAG above
# {link_id, source, destination, bandwidth, max_latency}
#
# Near-patient links (C0-C2): ultra-low latency required (Gia et al.)
# ML inference links (C2-C5): moderate latency acceptable
# Alert path (C5-C6-C8): low latency (clinical urgency)
# Dashboard (C5-C7): moderate latency
# Aggregation path (C9-C11): tolerates higher latency
links.description = \
{0,0,1,500,5}, \
{1,1,2,400,10}, \
{2,2,3,200,30}, \
{3,2,4,200,30}, \
{4,3,5,150,30}, \
{5,4,5,150,30}, \
{6,5,6,100,10}, \
{7,5,7,100,20}, \
{8,6,8,80,15}, \
{9,8,9,60,30}, \
{10,9,10,100,50}, \
{11,10,11,80,200}

links.nb = 12

# Locality constraints (DZ):
# C0  (ECG Sensor Hub)   MUST be on bedside hub -> H13 (ward A, bed 1)
# C11 (Cloud Analytics)  MUST be on cloud -> H0
# C7  (Patient Dashboard) MUST be on ward gateway (nurse station) -> H5
component.nbDZ = 3

component.DZ = \
{0, 13}, \
{11, 0}, \
{7, 5}
